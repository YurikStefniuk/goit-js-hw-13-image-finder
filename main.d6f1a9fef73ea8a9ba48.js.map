{"version":3,"sources":["webpack:///./templates/cardList.hbs","webpack:///./js/api-Key.js","webpack:///./index.js"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","nullContext","program","noop","apiService","this","searchQuery","page","renderedImg","fetchHits","url","BASE_URL","fetch","then","response","json","incrementPage","resetPage","newQuery","debounce","require","hitsApiService","HitsApiService","refs","searchForm","document","querySelector","galleryList","input","sentinel","galleryRequests","console","log","hits","totalHits","observer","observe","insertAdjacentHTML","imageListTpl","addHitsMarkup","unobserve","clearHitsContainer","innerHTML","addEventListener","e","preventDefault","query","target","value","trim","length","IntersectionObserver","entries","forEach","entry","isIntersecting","options","rootMargin","event","nodeName","changeModalImage","dataset","source","basicLightbox","show"],"mappings":"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","file":"main.d6f1a9fef73ea8a9ba48.js","sourcesContent":["var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"photo-card\\\">\\r\\n    <img src=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \"\\\" data-source=\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0), depth0))\n    + \" alt=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"tags\") : depth0), depth0))\n    + \"\\\" width=\\\"400\\\" />\\r\\n\\r\\n    <div class=\\\"stats\\\">\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n            \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"likes\") : depth0), depth0))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">visibility</i>\\r\\n            \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"views\") : depth0), depth0))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">comment</i>\\r\\n            \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"comments\") : depth0), depth0))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n            \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0), depth0))\n    + \"\\r\\n        </p>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":24,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});","// const BASE_URL = 'htpps://pixabay.com/api/'\r\n// const API_KEY = '19367124-00f5e2cf6611e77bac75c4628';\r\n\r\n// function fetchCards() {\r\n//     const url = `${BASE_URL}?key=${API_KEY}&q=${this.searchQuery}&image_type=photo&per_page=12&page=${this.page}`;\r\n//     return fetch(url)\r\n//         .then(response => response.json)\r\n    \r\n//  }\r\n\r\n// export default{fetchCards}\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\nconst API_KEY = '19367705-6c391461160466e2850694aab';\r\n\r\nexport default class apiService {\r\n    constructor() {\r\n        this.searchQuery = '';\r\n        this.page = 1;\r\n        this.renderedImg = 0;\r\n    }\r\n\r\n    fetchHits() {\r\n        const url = `${BASE_URL}?key=${API_KEY}&q=${this.searchQuery}&image_type=photo&per_page=12&page=${this.page}`;\r\n\r\n        return fetch(url)\r\n            .then(response => response.json())\r\n            .then((data) => {\r\n                this.incrementPage();\r\n\r\n                return data;\r\n            });\r\n    }\r\n\r\n    incrementPage() {\r\n        this.page += 1;\r\n    }\r\n\r\n    resetPage() {\r\n        this.page = 1;\r\n        this.renderedImg = 0;\r\n    }\r\n\r\n    // Если убрать get и set, тогда везьде обращаемся только к searchQuery, a не query \r\n    get query() {\r\n        return this.searchQuery;\r\n    }\r\n\r\n    set query(newQuery) {\r\n        this.searchQuery = newQuery;\r\n    }\r\n}","import './css/styles.css';\r\nimport imageListTpl from './templates/cardList.hbs';\r\nimport HitsApiService from './js/api-Key';\r\n\r\nimport * as basicLightbox from 'basiclightbox';\r\nimport 'basiclightbox/dist/basicLightbox.min.css';\r\n\r\nvar debounce = require('lodash.debounce');\r\nconst hitsApiService = new HitsApiService();\r\n\r\nconst refs = {\r\n    searchForm: document.querySelector('.search-form'),\r\n    galleryList: document.querySelector('.gallery'),\r\n    input: document.querySelector('.search-input'),\r\n    sentinel: document.querySelector('#sentinel'),\r\n};\r\n\r\nrefs.input.addEventListener('input', debounce(onSearch, 500));\r\n\r\nfunction onSearch(e) {\r\n    e.preventDefault();\r\n\r\n    hitsApiService.query = e.target.value.trim();\r\n    if(hitsApiService.query.length === 0) {\r\n        \r\n        return clearHitsContainer();\r\n    } \r\n\r\n    hitsApiService.resetPage();\r\n    clearHitsContainer();\r\n    onLoadMore(); \r\n}\r\n\r\nfunction onLoadMore() {\r\n   hitsApiService.fetchHits().then(galleryRequests);\r\n}\r\n\r\nfunction galleryRequests(data) {\r\n    console.log(data.hits);\r\n           \r\n        if(hitsApiService.renderedImg < data.totalHits) {\r\n            observer.observe(refs.sentinel);\r\n            addHitsMarkup(data.hits);\r\n            hitsApiService.renderedImg += 12;\r\n        }\r\n\r\n        if(hitsApiService.renderedImg === data.totalHits) {\r\n            observer.unobserve(refs.sentinel);\r\n            return;\r\n        }\r\n\r\n        if(hitsApiService.renderedImg + 12 > data.totalHits) {\r\n            observer.unobserve(refs.sentinel);\r\n        }\r\n    }\r\n\r\nfunction addHitsMarkup(data) {\r\n    refs.galleryList.insertAdjacentHTML('beforeend', imageListTpl(data));\r\n}\r\n\r\nfunction clearHitsContainer() {\r\n refs.galleryList.innerHTML = '';    \r\n}\r\n\r\nconst observer = new IntersectionObserver(onEntry, options);\r\n\r\n\r\n    function onEntry (entries) {\r\n        entries.forEach(entry => {\r\n            if (entry.isIntersecting && hitsApiService.query !== '') {\r\n                console.log(\"LOADING...\");\r\n                hitsApiService.fetchHits().then(galleryRequests);\r\n            }\r\n        });\r\n    }\r\n    const options = {\r\n        rootMargin: '100px'\r\n    }   \r\n\r\n//модалка basicLightbox\r\nrefs.galleryList.addEventListener('click', onGalleryElClick);    \r\n\r\nfunction onGalleryElClick(event) {\r\n        if (event.target.nodeName !== 'IMG') {\r\n          return;\r\n        }\r\n        \r\n        const changeModalImage = `<img src=${event.target.dataset.source} alt=\"icon\" />`;\r\n        const instance = basicLightbox.create(changeModalImage);\r\n        instance.show();\r\n }"],"sourceRoot":""}